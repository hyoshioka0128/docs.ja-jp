---
title: サーバーレス関数の活用
description: クラウドネイティブアプリケーションでのサーバーレスと Azure Functions の活用
ms.date: 06/30/2019
ms.openlocfilehash: 77ddef0eb8844ea1b55cd2fc5ec8aa12593c8631
ms.sourcegitcommit: 559fcfbe4871636494870a8b716bf7325df34ac5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/30/2019
ms.locfileid: "73841745"
---
# <a name="leveraging-serverless-functions"></a>サーバーレス関数の活用

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

クラウドの機能を活用するための完全なコンピューターとオペレーティングシステムの管理の範囲では、サーバーレスが非常に優れています。この場合、責任を負うのはコードだけで、コードの実行時にのみ課金されます。 Azure Functions によって、サーバーレス機能をアプリケーションに組み込むことができます。

## <a name="what-is-serverless"></a>サーバーレスとは

サーバーレスコンピューティングは、アプリケーションの実行に関連するサーバーが存在しないという意味ではありません。このコードは、サーバー上のどこかで実行されます。 この違いは、アプリケーション開発チームは、サーバーインフラストラクチャの管理について自身を意識する必要がなくなることです。 Azure Functions のようなサーバーレスコンピューティングソリューションでは、チームは生産性を向上させ、組織はリソースを最適化し、ソリューションの提供に専念することができます。

サーバーレスコンピューティングでは、イベントによってトリガーされるステートレスコンテナーを使用して、アプリケーションまたはアプリケーションの一部をホストします。 サーバーレスプラットフォームでは、必要に応じてスケールアウトおよびスケールインを行うことができます。 Azure Functions のようなプラットフォームでは、キュー、イベント、ストレージなどの他の Azure サービスに簡単に直接アクセスできます。

## <a name="what-challenges-are-solved-by-serverless"></a>サーバーレスによって解決される課題

サーバーレスは、独自のハードウェアを実行するという究極の抽象化です。 開発者は、独自のサーバーをホストするときに必要になる可能性がある次のタスクについて心配することなく、ビジネス上の問題を解決するコードの記述にのみ集中できます。

- 購入コンピューターとソフトウェアライセンス
- コンピューターとそのネットワーク、電力、および A/C の要件のハウジング、セキュリティ保護、構成、および保守
- オペレーティングシステムとソフトウェアの修正プログラムの適用とアップグレード
- アプリケーションソフトウェアをホストするための web サーバーまたはコンピューターサービスの構成
- プラットフォーム内でのアプリケーションソフトウェアの構成

多くの企業では、多数のスタッフメンバーを採用しており、これらのハードウェアインフラストラクチャの問題をサポートするために大きな予算を割り当てています。 単にクラウドに移行することで、これらの懸念事項の一部が排除されます。アプリケーションをサーバーレスに移行することで、残りの部分を排除できます。

## <a name="what-scenarios-are-appropriate-for-serverless"></a>サーバーレスに適したシナリオ

サーバーレスでは、何らかのトリガーに応答して呼び出される、個々の実行時間の短い関数を使用します。 これにより、バックグラウンドタスクの処理に最適です。

たとえば、アプリケーションでは、要求の処理の一環として電子メールを送信する必要がある場合があります。 Web 要求の処理の一環として電子メールを送信する代わりに、電子メールの詳細をキューに配置し、Azure 関数を使用してメッセージを取得し、電子メールを送信することができます。 アプリケーションのさまざまな部分 (または多くのアプリケーション) は、この同じ Azure 関数を利用できます。これにより、アプリケーションのパフォーマンスとスケーラビリティが向上し、[キューベースの負荷平準化](https://docs.microsoft.com/azure/architecture/patterns/queue-based-load-leveling)を使用して、電子メールの送信に関連するボトルネックを回避することができます。

アプリケーションと Azure Functions 間の[パブリッシャー/サブスクライバーパターン](https://docs.microsoft.com/azure/architecture/patterns/publisher-subscriber)は最も一般的なパターンですが、他のパターンを使用することもできます。 Azure Functions は、Azure Blob Storage への変更など、他のイベントによってトリガーできます。 イメージのアップロードをサポートするアプリケーションには、サムネイル画像を作成したり、アップロードされたイメージのサイズを一貫したサイズに変更したり、イメージのサイズを最適化したりする Azure 関数が含まれる場合があります。 この機能はすべて Azure Blob Storage に挿入することによって直接トリガーされる可能性があり、複雑さとワークロードはアプリケーション自体から除外されます。

多くのアプリケーションは、ワークフローの一部として実行時間の長いプロセスを持ちます。 多くの場合、これらのタスクはアプリケーションとのユーザー操作の一部として実行されるので、ユーザーは自分のエクスペリエンスを待機して悪影響を与えることになります。 サーバーレスコンピューティングは、ユーザー操作ループの外部での低速タスクを実行する優れた方法を提供します。これらのタスクは、アプリケーション全体を拡張する必要がなく、要求に応じて簡単に拡張できます。

## <a name="when-should-you-avoid-serverless"></a>サーバーレスを避ける必要がある場合

サーバーレスコンピューティングは、ユーザーインターフェイスをブロックしないタスクに最適です。 これは、web アプリケーションまたは web Api を直接ホストするのに最適ではないことを意味します。 その主な理由は、サーバーレスソリューションがプロビジョニングされ、必要に応じてスケーリングされることです。 *コールドスタート*と呼ばれる関数の新しいインスタンスが必要な場合は、プロビジョニングに時間がかかります。 通常、この時間は数秒ですが、さまざまな要因によってはより長い時間がかかることがあります。 (たとえば、定期的に要求を行うことによって) 1 つのインスタンスを無期限に保持できますが、スケールアップする必要があるインスタンスの数が多い場合は、コールドスタートの問題が残ります。

コールドスタートとウォームスタート ![](./media/cold-start-warm-start.png)
**図 3-10**。 コールドスタートとウォームスタート。

コールドスタートを完全に回避する必要がある場合は、[従量課金プランから専用プランに](https://azure.microsoft.com/blog/understanding-serverless-cold-start/)切り替えることができます。 また、premium プランで[1 つ以上の事前登録済みの med-v インスタンスを構成](https://docs.microsoft.com/azure/azure-functions/functions-premium-plan#pre-warmed-instances)することもできます。これにより、別のインスタンスを追加する必要があるときに、既に稼働状態になっています。 これらのオプションを使用すると、サーバーレスコンピューティングに関連する主な問題の1つを軽減できます。

また、実行時間の長いタスクについては、通常はサーバーレスを使用しないようにしてください。 これらは、すばやく完了できる小さな作業に最適です。 ほとんどのサーバーレスプラットフォームでは、数分以内に個々の機能が完了する必要があります。 Azure Functions 既定値は5分間です (10 分まで構成できます)。 Azure Functions premium プランでもこの問題を軽減できます。既定では30分にタイムアウトし、無制限の上限を構成することができます。

最後に、アプリケーション内の特定のタスクに対してサーバーレスを利用すると、複雑さが増します。 多くの場合、アプリケーションをモジュール化された疎結合方式で設計してから、サーバーレスで提供される利点によって複雑さが増すというメリットがあるかどうかを確認することをお勧めします。 小規模なアプリケーションの多くは、単一のモノリシックデプロイで完全に動作します。サーバーレスコンピューティングに必要な分散アプリケーションアーキテクチャは必要ありません。

## <a name="references"></a>参照

- [サーバーレスコールドスタートについて](https://azure.microsoft.com/blog/understanding-serverless-cold-start/)
- [事前に準備した med-v Azure Functions インスタンス](https://docs.microsoft.com/azure/azure-functions/functions-premium-plan#pre-warmed-instances)
- [カスタムイメージを使用して Linux で関数を作成する](https://docs.microsoft.com/azure/azure-functions/functions-create-function-linux-custom-image)

>[!div class="step-by-step"]
>[前へ](leverage-containers-orchestrators.md)
>[次へ](combine-containers-serverless-approaches.md)
